\ test.ok - automated tests for okami
\ Copyright (C) 2018 Wolfgang Jaehrling
\
\ ISC License
\
\ Permission to use, copy, modify, and/or distribute this software for any
\ purpose with or without fee is hereby granted, provided that the above
\ copyright notice and this permission notice appear in all copies.
\
\ THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
\ WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
\ MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
\ ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
\ WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
\ ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
\ OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

\ we want to check whether a mess was created on the stack
: magic1 [4453];
: magic2 [9871];
: test{ [magic1 magic2];
: assert [and and] if [46] else [70] then [emit];
: } [>r magic2 = >r magic1 = r> r> assert];

\ recursion
: fact [dup 0=] if [1+] else [dup 1- fact *] then ;
test{ 0 fact 1 = }
test{ 5 fact 120 = }
: fib [dup 1 >] if [dup 1- fib swap 2 - fib +] then ;
test{ 10 fib 55 = }

\ end of tests
cr bye
